@model List<HomeSection>
@inject Microsoft.Extensions.Localization.IStringLocalizer<SharedResource> L

<div class="d-flex align-items-center justify-content-between mt-2 mb-2">
    <h2 class="mb-0">@L["Admin.HomeSections"]</h2>
    <a asp-action="Create" class="btn btn-primary">
        @L["Admin.CreateNewSection"] <i class="fas fa-plus-circle ms-1"></i>
    </a>
</div>

<div class="table-responsive">
    <table class="table table-striped align-middle">
        <thead>
            <tr>
                <th style="width:60px;">@L["Admin.Order"]</th>
                <th>
                    @(
                        (L["Admin.TitleEn"]?.Value?.Length > 0 ? L["Admin.TitleEn"].Value :
                        (L["Admin.TitlePreview"]?.Value?.Length > 0 ? L["Admin.TitlePreview"].Value : "Title (EN)"))
                    )
                </th>
                <th style="min-width:220px;">
                    @(
                        L["Admin.TitleIt"]?.Value ?? "Title (IT)"
                    )
                </th>
                <th style="min-width:220px;">
                    @(
                        L["Admin.TitleAr"]?.Value ?? "Title (AR)"
                    )
                </th>
                <th style="width:90px;">@L["Admin.ItemsCount"]</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            @foreach (var s in Model)
            {
                var en = s.Translations?.FirstOrDefault(x => x.Culture == "en")?.Title;
                var it = s.Translations?.FirstOrDefault(x => x.Culture == "it")?.Title;
                var ar = s.Translations?.FirstOrDefault(x => x.Culture == "ar")?.Title;

                // fallbacks
                en = string.IsNullOrWhiteSpace(en) ? "-" : en;
                it = string.IsNullOrWhiteSpace(it) ? "-" : it;
                ar = string.IsNullOrWhiteSpace(ar) ? "-" : ar;

                <tr>
                    <td class="align-middle">@s.Order</td>

                    <td class="align-middle">
                        <div class="d-flex flex-column">
                            <div>
                                <span class="badge bg-light text-dark small me-2">EN</span>
                                <span class="fw-semibold">@en</span>
                            </div>
                        </div>
                    </td>

                    <td class="align-middle">
                        <div class="d-flex flex-column">
                            <div>
                                <span class="badge bg-light text-dark small me-2">IT</span>
                                <span class="fw-semibold">@it</span>
                            </div>
                        </div>
                    </td>

                    <td class="align-middle">
                        <div class="d-flex flex-column" dir="rtl">
                            <div class="text-end">
                                <span class="badge bg-light text-dark small me-2">AR</span>
                                <span class="fw-semibold">@ar</span>
                            </div>
                        </div>
                    </td>

                    <td class="align-middle text-center">@((s.Items?.Count) ?? 0)</td>

                    <td class="align-middle text-end text-nowrap">
                        <a asp-action="Edit" asp-route-id="@s.Id" class="btn btn-sm btn-outline-primary me-1">@L["Admin.Edit"]</a>
                        <a asp-action="Delete" asp-route-id="@s.Id" class="btn btn-sm btn-outline-danger">@L["Admin.Delete"]</a>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>
